<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cobrinha Pendinha</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #0b1d13;
  font-family: Arial, Helvetica, sans-serif;
}

#gameContainer {
  position: relative;
  max-width: 520px;
  margin: 20px auto;
}

canvas {
  width: 100%;
  height: auto;
  background: linear-gradient(#1e3d2b, #0b1d13);
  border-radius: 14px;
  display: block;
}

/* UI */
#ui {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 16px;
  z-index: 10;
}

/* Fullscreen */
#fullscreenBtn {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 10;
  background: rgba(0,0,0,0.6);
  color: white;
  border: none;
  border-radius: 6px;
  padding: 6px 10px;
  cursor: pointer;
  font-size: 18px;
}

/* MENU */
#menu {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
  background: rgba(0,0,0,0.65);
  z-index: 20;
}

.colorPicker {
  display: flex;
  gap: 8px;
  margin: 12px 0;
}

.color {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid #fff;
}

.color.selected {
  outline: 3px solid #00e676;
}

#startBtn {
  margin-top: 16px;
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: #00e676;
  color: #000;
}
</style>
</head>

<body>

<div id="gameContainer">
  <button id="fullscreenBtn">‚õ∂</button>
  <canvas id="game" width="360" height="520"></canvas>

  <div id="ui">
    Pontos: <span id="score">0</span> |
    Fase: <span id="phase">1</span>
  </div>

  <div id="menu">
    <h2>üêç Cobrinha Pendinha</h2>
    <p>Escolha a cor da cobra</p>
    <div class="colorPicker" id="colors"></div>
    <button id="startBtn">‚ñ∂ Iniciar Jogo</button>
  </div>
</div>

<script>
/* ============================================================
   ====================== CONFIGURA√á√ÉO ========================
   ============================================================ */

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const W = canvas.width;
const H = canvas.height;

const COLORS = [
  "#4caf50","#ff5722","#2196f3","#e91e63","#9c27b0",
  "#ffeb3b","#00bcd4","#8bc34a","#ff9800","#795548"
];

let selectedColor = COLORS[0];

let score = 0;
let phase = 1;
const MAX_PHASE = 20;

let running = false;
let bgOffset = 0;
let attackCooldown = 0;

/* ============================================================
   ====================== PLAYER SNAKE ========================
   ============================================================ */

const snake = {
  x: W / 2,
  y: H / 2,
  angle: 0,
  speed: 2.2,
  length: 12,
  body: [],
  eyeBlink: 0,
  tongue: 0
};

/* ============================================================
   ====================== OBJETOS DE JOGO =====================
   ============================================================ */

let food = {};
let enemySnakes = [];
let boss = null;

let playerShots = [];
let bossShots = [];

/* ============================================================
   ====================== FULLSCREEN ==========================
   ============================================================ */

document.getElementById("fullscreenBtn").onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

/* ============================================================
   ====================== MENU / CORES ========================
   ============================================================ */

const colorsDiv = document.getElementById("colors");

COLORS.forEach(color => {
  const div = document.createElement("div");
  div.className = "color";
  div.style.background = color;

  if (color === selectedColor) div.classList.add("selected");

  div.onclick = () => {
    selectedColor = color;
    document.querySelectorAll(".color").forEach(c => c.classList.remove("selected"));
    div.classList.add("selected");
  };

  colorsDiv.appendChild(div);
});

document.getElementById("startBtn").onclick = startGame;

/* ============================================================
   ====================== INPUT ===============================
   ============================================================ */

canvas.addEventListener("mousemove", e => {
  if (!running) return;

  const rect = canvas.getBoundingClientRect();
  const mx = (e.clientX - rect.left) * (W / canvas.clientWidth);
  const my = (e.clientY - rect.top) * (H / canvas.clientHeight);

  snake.angle = Math.atan2(my - snake.y, mx - snake.x);
});

canvas.addEventListener("mousedown", () => {
  if (!running) return;

  if (attackCooldown <= 0) {
    attackCooldown = 25;
    shootPlayer();
  }
});

/* ============================================================
   ====================== START / RESET =======================
   ============================================================ */

function startGame() {
  document.getElementById("menu").style.display = "none";

  score = 0;
  phase = 1;
  updateUI();

  resetSnake();
  enemySnakes = [];
  playerShots = [];
  bossShots = [];

  spawnFood();
  spawnBoss();

  running = true;
}

function resetSnake() {
  snake.x = W / 2;
  snake.y = H / 2;
  snake.angle = 0;
  snake.length = 12;
  snake.body = [];
}

/* ============================================================
   ====================== SPAWN ===============================
   ============================================================ */

function spawnFood() {
  food = {
    x: Math.random() * (W - 40) + 20,
    y: Math.random() * (H - 40) + 20,
    angle: Math.random() * Math.PI * 2,
    speed: 1.4
  };
}

function spawnEnemySnake(size = 3) {
  enemySnakes.push({
    x: Math.random() * (W - 80) + 40,
    y: Math.random() * (H - 80) + 40,
    angle: Math.random() * Math.PI * 2,
    speed: 1.1,
    size,
    length: size * 6,
    body: []
  });
}

function spawnBoss() {
  boss = {
    x: W / 2,
    y: 80,
    angle: Math.PI / 2,
    speed: 0.8 + phase * 0.08,
    life: 3 + phase,
    maxLife: 3 + phase,
    length: 30 + phase * 4,
    body: []
  };
}

/* ============================================================
   ====================== UI ================================
   ============================================================ */

function updateUI() {
  document.getElementById("score").textContent = score;
  document.getElementById("phase").textContent = phase;
}

/* ============================================================
   ====================== GAME OVER ===========================
   ============================================================ */

function gameOver() {
  running = false;
  document.getElementById("menu").style.display = "flex";
}

/* ============================================================
   ====================== ATAQUE PLAYER =======================
   ============================================================ */

function shootPlayer() {
  playerShots.push({
    x: snake.x,
    y: snake.y,
    angle: snake.angle,
    speed: 6,
    radius: 4
  });
}

/* ============================================================
   ====================== LOOP BASE ===========================
   ============================================================ */

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
<script>
/* ============================================================
   ====================== UPDATE PRINCIPAL ===================
   ============================================================ */

let bossShootTimer = 0;

function update() {
  if (!running) return;

  bgOffset += 0.4;
  if (attackCooldown > 0) attackCooldown--;

  /* ================= PLAYER ================= */
  snake.x += Math.cos(snake.angle) * snake.speed;
  snake.y += Math.sin(snake.angle) * snake.speed;

  // Limites da tela
  snake.x = Math.max(10, Math.min(W - 10, snake.x));
  snake.y = Math.max(10, Math.min(H - 10, snake.y));

  snake.body.unshift({ x: snake.x, y: snake.y });
  if (snake.body.length > snake.length) snake.body.pop();

  snake.eyeBlink = (snake.eyeBlink + 1) % 220;
  snake.tongue += 0.15;

  /* ================= COMIDA ================= */
  food.angle += (Math.random() - 0.5) * 0.2;
  food.x += Math.cos(food.angle) * food.speed;
  food.y += Math.sin(food.angle) * food.speed;

  food.x = Math.max(20, Math.min(W - 20, food.x));
  food.y = Math.max(20, Math.min(H - 20, food.y));

  if (Math.hypot(snake.x - food.x, snake.y - food.y) < 16) {
    snake.length += 4;
    score++;
    updateUI();
    spawnFood();

    if (score % 5 === 0) {
      spawnEnemySnake(Math.floor(Math.random() * 4) + 2);
    }
  }

  /* ================= COBRINHAS PEQUENAS ================= */
  enemySnakes.forEach((e, i) => {
    const dist = Math.hypot(snake.x - e.x, snake.y - e.y);

    if (dist < 70) {
      e.angle = Math.atan2(e.y - snake.y, e.x - snake.x);
    } else {
      e.angle += (Math.random() - 0.5) * 0.1;
    }

    e.x += Math.cos(e.angle) * e.speed;
    e.y += Math.sin(e.angle) * e.speed;

    e.body.unshift({ x: e.x, y: e.y });
    if (e.body.length > e.length) e.body.pop();

    if (Math.hypot(snake.x - e.x, snake.y - e.y) < 14) {
      score += e.size;
      enemySnakes.splice(i, 1);
      updateUI();
    }
  });

  /* ================= TIROS DO PLAYER ================= */
  playerShots.forEach((s, i) => {
    s.x += Math.cos(s.angle) * s.speed;
    s.y += Math.sin(s.angle) * s.speed;

    if (s.x < 0 || s.x > W || s.y < 0 || s.y > H) {
      playerShots.splice(i, 1);
      return;
    }

    if (boss && Math.hypot(s.x - boss.x, s.y - boss.y) < 20) {
      boss.life--;
      playerShots.splice(i, 1);

      if (boss.life <= 0) {
        score += 10;
        phase++;
        updateUI();

        if (phase > MAX_PHASE) {
          alert("üèÜ Voc√™ zerou o jogo!");
          gameOver();
          return;
        }

        spawnBoss();
      }
    }
  });

  /* ================= BOSS ================= */
  updateBoss();

  /* ================= TIROS DO BOSS ================= */
  bossShots.forEach((b, i) => {
    b.x += Math.cos(b.angle) * b.speed;
    b.y += Math.sin(b.angle) * b.speed;

    if (Math.hypot(snake.x - b.x, snake.y - b.y) < 10) {
      gameOver();
    }

    if (b.x < 0 || b.x > W || b.y < 0 || b.y > H) {
      bossShots.splice(i, 1);
    }
  });
}

/* ============================================================
   ====================== BOSS IA ============================
   ============================================================ */

function updateBoss() {
  if (!boss) return;

  const dist = Math.hypot(snake.x - boss.x, snake.y - boss.y);

  if (dist < 220) {
    boss.angle = Math.atan2(snake.y - boss.y, snake.x - boss.x);
    boss.x += Math.cos(boss.angle) * boss.speed;
    boss.y += Math.sin(boss.angle) * boss.speed;
  }

  boss.body.unshift({ x: boss.x, y: boss.y });
  if (boss.body.length > boss.length) boss.body.pop();

  if (dist < 18) gameOver();

  bossShootTimer++;
  const delay = Math.max(90 - phase * 3, 30);

  if (bossShootTimer > delay) {
    bossShootTimer = 0;
    bossShots.push({
      x: boss.x,
      y: boss.y,
      angle: boss.angle,
      speed: 2 + phase * 0.05,
      radius: 4
    });
  }
}

/* ============================================================
   ====================== DRAW ================================
   ============================================================ */

function draw() {
  drawBackground();
  drawFood();
  drawEnemies();
  drawBoss();
  drawPlayerShots();
  drawBossShots();
  drawSnake();
}

function drawBackground() {
  ctx.fillStyle = "#102e1c";
  ctx.fillRect(0, 0, W, H);

  ctx.fillStyle = "rgba(255,255,255,0.05)";
  for (let i = 0; i < 20; i++) {
    ctx.beginPath();
    ctx.arc((i * 40 + bgOffset) % W, (i * 30) % H, 20, 0, Math.PI * 2);
    ctx.fill();
  }
}

function drawSnake() {
  ctx.fillStyle = selectedColor;

  snake.body.forEach((p, i) => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, 8 - i * 0.02, 0, Math.PI * 2);
    ctx.fill();
  });

  ctx.beginPath();
  ctx.arc(snake.x, snake.y, 10, 0, Math.PI * 2);
  ctx.fill();

  if (snake.eyeBlink < 180) {
    ctx.fillStyle = "#000";
    ctx.beginPath();
    ctx.arc(
      snake.x + Math.cos(snake.angle + 0.5) * 5,
      snake.y + Math.sin(snake.angle + 0.5) * 5,
      2, 0, Math.PI * 2
    );
    ctx.arc(
      snake.x + Math.cos(snake.angle - 0.5) * 5,
      snake.y + Math.sin(snake.angle - 0.5) * 5,
      2, 0, Math.PI * 2
    );
    ctx.fill();
  }

  ctx.strokeStyle = "#ff1744";
  ctx.beginPath();
  ctx.moveTo(snake.x, snake.y);
  ctx.lineTo(
    snake.x + Math.cos(snake.angle) * (10 + Math.sin(snake.tongue) * 6),
    snake.y + Math.sin(snake.angle) * (10 + Math.sin(snake.tongue) * 6)
  );
  ctx.stroke();
}

function drawFood() {
  ctx.fillStyle = "#ffeb3b";
  ctx.beginPath();
  ctx.arc(food.x, food.y, 6, 0, Math.PI * 2);
  ctx.fill();
}

function drawEnemies() {
  ctx.fillStyle = "#2e7d32";
  enemySnakes.forEach(e => {
    e.body.forEach((p, i) => {
      ctx.beginPath();
      ctx.arc(p.x, p.y, 6 - i * 0.05, 0, Math.PI * 2);
      ctx.fill();
    });
  });
}

function drawBoss() {
  if (!boss) return;

  ctx.fillStyle = "#b71c1c";
  boss.body.forEach((p, i) => {
    ctx.beginPath();
    ctx.arc(p.x, p.y, 7 - i * 0.02, 0, Math.PI * 2);
    ctx.fill();
  });

  ctx.fillStyle = "#fff";
  ctx.fillRect(boss.x - 20, boss.y - 30, 40, 5);
  ctx.fillStyle = "#e53935";
  ctx.fillRect(
    boss.x - 20,
    boss.y - 30,
    40 * (boss.life / boss.maxLife),
    5
  );
}

function drawPlayerShots() {
  ctx.fillStyle = "#00e5ff";
  playerShots.forEach(s => {
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawBossShots() {
  ctx.fillStyle = "#ff5252";
  bossShots.forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, b.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}
</script>
